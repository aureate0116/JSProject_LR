{"version":3,"sources":["acc_account.js","acc_profile.js","acc_resources.js","add_resource.js","all.js","config.js","index.js","layout.js","login.js","resource.js","resource_list.js","signup.js","timestamp.js"],"names":["apiUrl","userId","location","href","split","localStorageUserId","localStorage","getItem","localStorageToken","headers","Authorization","userData","initAccount","axios","get","then","res","data","renderUserAccount","err","request","status","document","clearLocalStorage","console","log","userEmail","querySelector","userPW","leftMenu","value","email","leftMenuStr","innerHTML","constraints","oldPassowrd","presence","message","length","minimum","newPassword","confirmpw","equality","attribute","initProfile","renderUserData","response","firstName","lastName","userTitle","userExp","profileImg","title","undefined","experiences","prefix","toUpperCase","profileImgStr","profileInputs","querySelectorAll","forEach","item","addEventListener","e","nextElementSibling","textContent","btnSaveProfile","patch","Swal","fire","text","icon","iconColor","showConfirmButton","timer","initAccountResources","getAccountUserData","getAccountBookmarkData","userResourcesList","renderUserResList","userBookmark","error","reponse","resItemStr","score","resource","averageScore","starStr","combineCommentStarbyScore","combineResRow","imgUrl","id","url","toFixed","scoreStr","toString","i","target","getAttribute","bookmarkId","showCancelButton","confirmButtonColor","cancelButtonColor","confirmButtonText","cancelButtonText","result","isConfirmed","reload","wrapperLoading","clear","setTimeout","test","displayNoneWrapper","setAttribute","displayBlockWrapper","locationHref","resTopic","resId","initIndex","getResourcesForIndex","goodRate1","goodRate2","goodRate3","goodRate1Tab","goodRate2Tab","goodRate3Tab","resourceType1","resourceType2","resourceType3","resource1Tab","resource2Tab","resource3Tab","resourcesData","commentsData","sortGoodRateResources","renderGoodRateList","renderNewFreeList","commentScoreNum","getAverageScore","resultScore","commentNum","combineCommentStar","itemNum1","itemNum2","itemNum3","renderMaxNum","tabJS","tabHtml","tabPython","topics","combineResouorceItemType1","tabOnline","tabOffline","tabArticle","price","type","combineResouorceItem","resRenderList","sort","a","b","localStorageUserToken","beforeLogin","afterLogin","accountMenuImg","accountMenu","logOut","renderAccountMenu","accountMenuImgStr","accountMenuStr","setItem","loginAccount","loginPw","btnLogin","initLogin","getUserListbyLoginPage","usersData","filter","userItem","preventDefault","post","accessToken","user","parseFloat","initResourcePage","getResourcesForResources","getCommentData","getResourcesItem","getResourcesComment","getUserData","getbookmarkData","renderRelatedResource","resourceContent","resourceCommentData","renderResource","renderComment","submitComment","imageNBrief","titleBox","btnResLink","renderItem","userName","role","imageNBriefStr","titleBoxStr","btnBoxStr","level","lang","intro","commentList","commentSort","commentStr","btnReadMore","newResultScoreOjb","commentTimeAge","Ftime","commentTime","content","likeNum","dislikeNum","relatedResource","relatedTitle","relatedStr","renderNum","resItem","btnComment","commentContent","userInfo","btnCommentSubmit","commentStar","commentTextarea","btnBookmark","renderBtnCommentContent","renderBookmark","userInfoStr","resourceId","thisTime","Date","now","starNum","starItem","index","totalScore","thisResAverageScore","newAverageScore","NaN","initResourceList","bannerBlockTitle","foundation1Basic","foundation2Free","foundation3CN","thisTopicData","renderFoundationRecommond","renderFilterResultList","sortResourcesList","basicStr","freeStr","cnStr","langItem","scoreTotal","resourceIdObj","newResultScore","resourceIdArr","Object","keys","scoreArr","values","relatedTopic","resourceItem","filterItemInput","checkObj","renderList","newSortRenderList","filterKeyword","groupName","checked","push","hasType","hasLevel","hasPrice","checkLang","includes","some","str","sortList","renderfilterStr","combineResouorceItemType2","resultNumber","clearBtnText","clearFilterBtn","resourceSort","signUpForm","signupLastName","signupfirstName","signupMail","signupPw","signupPwConfirm","signUpFormInputs","btnSignUp","initSignup","getUserList","lastname","firstname","password","errors","validate","timespan","dateTime","year","getFullYear","month","getMonth","day","getDate","hour","getHours","minute","getMinutes","parse","milliseconds","timeSpanStr","Math","ceil"],"mappings":"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","file":"all.js","sourcesContent":["const apiUrl=\"https://json-server-vercel-ochre.vercel.app\";\r\n\r\nlet userId = location.href.split(\"=\")[1];\r\nlet localStorageUserId = localStorage.getItem(\"userId\");  \r\nlet localStorageToken = localStorage.getItem(\"accessToken\");\r\n// let pageClassify = location.href.split(\"/\")[3].split(\".html\")[0];\r\nlet headers = {\r\n    Authorization: `Bearer ${localStorageToken}` \r\n}\r\n// let homePage = location.href.split(\"/\")[0]+`//`+location.href.split(\"/\")[2];\r\n\r\n//如果localStorage userid 是空的 或是 該id 跟 這個page的id 不同 ，就轉跳至首頁\r\n//取得該用戶資料\r\nlet userData=[];\r\nfunction initAccount(){\r\n    if(localStorageUserId == userId && localStorageUserId !==\"\"){\r\n        axios.get(`${apiUrl}/users?id=${localStorageUserId}`,headers)\r\n        .then(res=>{\r\n            userData = res.data;\r\n            renderUserAccount();\r\n        \r\n        }).catch(err=>{\r\n            if (err.request.status === 403) {\r\n                document.location.href = `./acc_account.html?userid=${localStorageUserId}`;\r\n            } else if (err.request.status === 401) {\r\n                clearLocalStorage();\r\n            };\r\n            console.log(err);\r\n        })\r\n    }else{\r\n        // if( location.href !== `${homePage}/index.html`){\r\n        //     if( pageClassify!==\"resource\" && pageClassify!==\"resource_list\" \r\n        //     && location.href!==homePage+\"/login.html\"\r\n        //     && location.href!==homePage+\"/signup.html\"\r\n        //     && location.href!==homePage+\"/acc_account.html\"\r\n        //     && location.href!==homePage+\"/acc_resources.html\"){\r\n        //         location.href = `./index.html`;\r\n        //     }\r\n        // }\r\n    }\r\n}\r\ninitAccount();\r\n\r\n\r\n//渲染既有資料\r\nconst userEmail = document.querySelector('#userEmail');\r\nconst userPW = document.querySelector('#userPW');\r\n\r\nconst leftMenu = document.querySelector('.leftMenu');\r\n\r\n\r\nfunction renderUserAccount(){\r\n    if(userEmail!=null){\r\n        userEmail.value = userData[0].email;\r\n    }\r\n\r\n    let leftMenuStr=`<ul class=\"nav flex-row flex-lg-column\">\r\n        <li class=\"nav-item \">\r\n        <a class=\"nav-link active ps-0 px-lg-3\" aria-current=\"page\" href=\"./acc_profile.html?userid=${localStorageUserId}\">個人資料</a>\r\n        </li>\r\n        <li class=\"nav-item\">\r\n        <a class=\"nav-link ps-0 px-lg-3\" href=\"./acc_account.html?userid=${localStorageUserId}\">帳戶安全</a>\r\n        </li>\r\n        <!-- <li class=\"nav-item ps-0 px-lg-3\">\r\n        <a class=\"nav-link\" href=\"#\">通知</a>\r\n        </li> -->\r\n    </ul>  `;\r\n    if(leftMenu!=null){\r\n        leftMenu.innerHTML = leftMenuStr;\r\n    }\r\n}\r\n\r\n\r\n\r\nconst constraints ={\r\n    oldPassowrd:{\r\n        presence: {message: \"必填欄位\"},\r\n        length: {\r\n            minimum: 5, \r\n            message: \"密碼長度請大於5\"\r\n        }\r\n    },\r\n    newPassword:{\r\n        presence: {message: \"必填欄位\"},\r\n        length: {\r\n            minimum: 5, \r\n            message: \"密碼長度請大於5\"\r\n        }\r\n    },\r\n    confirmpw:{\r\n        presence: {message: \"必填欄位\"},\r\n        equality:{\r\n            attribute:\"newPassword2\",\r\n            message: \"與前者輸入密碼不同\",\r\n            // comparator: function(v1, v2) {\r\n            //     return v1 === v2;\r\n            //   }\r\n        }\r\n    }\r\n}","const apiUrl=\"https://json-server-vercel-ochre.vercel.app\";\r\n\r\nlet userId = location.href.split(\"=\")[1];\r\nlet localStorageUserId = localStorage.getItem(\"userId\");  \r\nlet localStorageToken = localStorage.getItem(\"accessToken\");\r\n// let pageClassify = location.href.split(\"/\")[3].split(\".html\")[0];\r\nlet headers = {\r\n    headers:{\r\n        \"authorization\": `Bearer ${localStorageToken}` \r\n    }\r\n}\r\n// let homePage = location.href.split(\"/\")[0]+`//`+location.href.split(\"/\")[2];\r\n\r\n//如果localStorage userid 是空的 或是 該id 跟 這個page的id 不同 ，就轉跳至首頁\r\n//取得該用戶資料\r\nlet userData=[];\r\nfunction initProfile(){\r\n    if(localStorageUserId == userId && localStorageUserId !==\"\"){\r\n        axios.get(`${apiUrl}/users?id=${localStorageUserId}`,headers)\r\n        .then(res=>{\r\n            userData = res.data;\r\n            renderUserData();\r\n        \r\n        }).catch(err=>{\r\n            //console.log(err);\r\n            if (err?.response?.status === 403) {\r\n                document.location.href = `./acc_resources.html?userid=${localStorageUserId}`;\r\n            } else if (err?.response?.status === 401) {\r\n                clearLocalStorage();\r\n            };\r\n        })\r\n    }else{\r\n        // if( location.href !== `${homePage}/index.html`){\r\n        //     if( pageClassify!==\"resource\" && pageClassify!==\"resource_list\" \r\n        //     && location.href!==homePage+\"/login.html\"\r\n        //     && location.href!==homePage+\"/signup.html\"\r\n        //     && location.href!==homePage+\"/acc_account.html\"\r\n        //     && location.href!==homePage+\"/acc_resources.html\"){\r\n                \r\n        //     }\r\n        // }\r\n        //location.href = `./index.html`;\r\n    }\r\n}\r\ninitProfile();\r\n\r\n\r\n//渲染用戶既有資料\r\n\r\nconst firstName = document.querySelector('#firstName');\r\nconst lastName = document.querySelector('#lastName');\r\nconst userTitle = document.querySelector('#userTitle');\r\nconst userExp = document.querySelector('#userExp');\r\n// const websiteUrl = document.querySelector('#websiteUrl');\r\nconst profileImg = document.querySelector('.profileImg');\r\n\r\n//左側選單\r\nconst leftMenu = document.querySelector('.leftMenu');\r\n\r\nfunction renderUserData() {\r\n    if(firstName!==null){\r\n        firstName.value = userData[0].firstName;\r\n    }\r\n    if(lastName!==null){\r\n        lastName.value = userData[0].lastName;\r\n    }\r\n   \r\n    if(userData[0].title!=undefined){\r\n        if(userTitle!==null){\r\n            userTitle.value = userData[0].title;\r\n        }\r\n    }\r\n    if(userData[0].experiences!=undefined){\r\n        if(userExp!==null){\r\n            userExp.value = userData[0].experiences;\r\n        }\r\n    }\r\n    // if( userData[0].links.websiteUrl!=undefined){\r\n    //     websiteUrl.value = userData[0].links.websiteUrl;\r\n    // }\r\n\r\n    // console.log(profileImg);\r\n    let prefix = (userData[0].firstName)[0].toUpperCase();\r\n    \r\n    let profileImgStr=`\r\n    <span class=\"userImg d-inline-block bg-primary p-4 rounded-circle fw-bold lh-1 text-white text-center\">${prefix}</span>`;\r\n    if(profileImg!==null){\r\n        profileImg.innerHTML = profileImgStr;\r\n    }\r\n\r\n\r\n    let leftMenuStr=`<ul class=\"nav flex-row flex-lg-column\">\r\n        <li class=\"nav-item \">\r\n        <a class=\"nav-link active ps-0 px-lg-3\" aria-current=\"page\" href=\"./acc_profile.html?userid=${localStorageUserId}\">個人資料</a>\r\n        </li>\r\n        <li class=\"nav-item\">\r\n        <a class=\"nav-link ps-0 px-lg-3\" href=\"./acc_account.html?userid=${localStorageUserId}\">帳戶安全</a>\r\n        </li>\r\n        <!-- <li class=\"nav-item ps-0 px-lg-3\">\r\n        <a class=\"nav-link\" href=\"#\">通知</a>\r\n        </li> -->\r\n    </ul>  `;\r\n    if(leftMenu!==null){\r\n        leftMenu.innerHTML = leftMenuStr;\r\n    }\r\n\r\n}\r\n\r\n//如果欄位編輯, 檢查欄位格式\r\nconst profileInputs = document.querySelectorAll('.profileInput');\r\nif(profileInputs!==null){\r\n    profileInputs.forEach(item=>{\r\n        item.addEventListener(\"change\",e=>{\r\n            item.nextElementSibling.textContent = '';\r\n            if(firstName.value ==\"\"){\r\n                document.querySelector('.firstName').textContent = '必填欄位';\r\n            }\r\n            if(lastName.value==\"\"){\r\n                document.querySelector('.lastName').textContent = '必填欄位';\r\n            }\r\n            if(userTitle.value.length > 15){\r\n                document.querySelector('.userTitle').textContent = '字述請少於15';\r\n            }\r\n            // if(websiteUrl.value){\r\n    \r\n            // }\r\n        })\r\n    })\r\n}\r\n\r\n\r\n\r\n//上傳圖片\r\n\r\n//儲存按鈕監聽,格式正確才儲存\r\nconst btnSaveProfile=document.querySelector('.btnSaveProfile');\r\nif(btnSaveProfile!==null){\r\n    btnSaveProfile.addEventListener(\"click\",e=>{\r\n        if(firstName.value !==\"\" && lastName.value!==\"\" && userTitle.value.length < 15){\r\n               \r\n            axios.patch(`https://json-server-vercel-ochre.vercel.app/600/users/${localStorageUserId}`,{\r\n                \"lastName\" : lastName.value,\r\n                \"firstName\" : firstName.value,\r\n                \"title\" : userTitle.value,\r\n                \"experiences\" : userExp.value,\r\n            },headers)\r\n            .then(res=>{\r\n            \r\n                Swal.fire({\r\n                    text:\"已成功更新\",\r\n                    icon: 'success',\r\n                    iconColor:\"#4AA9B6\",        \r\n                    showConfirmButton: false,\r\n                    timer: 2000\r\n                })\r\n               \r\n                //console.log(res.data);\r\n            }).catch(err=>{\r\n                if (err.request.status === 403) {\r\n                    document.location.href = `./acc_profile.html?userid=${localStorageUserId}`;\r\n                } else if (err?.response?.status === 401) {\r\n                    clearLocalStorage();\r\n                };\r\n               \r\n            })\r\n           \r\n        }\r\n    })\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n","const apiUrl=\"https://json-server-vercel-ochre.vercel.app\";\r\n\r\nfunction initAccountResources(){\r\n    getAccountUserData();\r\n    getAccountBookmarkData();\r\n    \r\n}\r\ninitAccountResources();\r\n\r\nconst userResourcesList = document.querySelector('.userResourcesList');\r\n\r\n//取得用戶資料\r\nlet localStorageUserId = localStorage.getItem(\"userId\");  \r\nlet localStorageToken = localStorage.getItem(\"accessToken\");\r\n\r\n// document.querySelector(\"body\").setAttribute(\"style\",\"overflow-y:hidden\");\r\n\r\nlet userData=[];\r\nfunction getAccountUserData(){\r\n    axios.get(`${apiUrl}/users?id=${localStorageUserId}`)\r\n    .then(res=>{\r\n        userData = res.data;\r\n        document.title =\"我的資源\";\r\n        renderUserResList();\r\n  \r\n    }).catch(err=>{\r\n        if (err?.response?.status === 403) {\r\n            document.location.href = `/acc_resources.html?userid=${localStorageUserId}`;\r\n        } else if (err?.response?.status === 401) {\r\n            clearLocalStorage();\r\n        };\r\n      console.log(err);\r\n    })\r\n}\r\n\r\n//取得收藏資料\r\nlet userBookmark=[];\r\nfunction getAccountBookmarkData(){\r\n    axios.get(`https://json-server-vercel-ochre.vercel.app/bookmarks?_expand=resource&&userId=${localStorageUserId}`)\r\n    .then(res=>{\r\n        userBookmark = res.data;\r\n        renderUserResList();\r\n  \r\n    }).catch(error=>{\r\n        console.log(error);\r\n        if (err?.reponse?.status == 403) {\r\n            document.location.href = `./acc_account.html?userid=${localStorageUserId}`;\r\n        } else if (err?.response?.status == 401) {\r\n            clearLocalStorage();\r\n        };\r\n        \r\n    })\r\n}\r\n\r\n\r\nfunction renderUserResList(){\r\n    let resItemStr=\"\";\r\n\r\n    if(userBookmark.length!=0){\r\n        userBookmark.forEach(item=>{\r\n            console.log(userBookmark);\r\n            let score;\r\n            if(item?.resource?.averageScore !== undefined){\r\n                score = item?.resource?.averageScore ;\r\n            }else{\r\n                score = 0;\r\n            }\r\n            //console.log(score,item.id);\r\n            let starStr=\"\";\r\n            if(score!==0){\r\n                starStr = combineCommentStarbyScore(score);\r\n            }\r\n            //console.log(starStr);\r\n            resItemStr += combineResRow(item,starStr);\r\n        })    \r\n        if(userResourcesList!=null){\r\n            userResourcesList.innerHTML = resItemStr;\r\n        }\r\n    }else{\r\n        if(userResourcesList!=null){\r\n            userResourcesList.innerHTML = `<div class=\"row\">\r\n            <div class=\"col text-center py-6 text-gray\">您目前沒有收藏的資源</div></div> `;\r\n        }\r\n    }\r\n}\r\n\r\nfunction combineResRow(item,starStr){\r\n    //console.log(item.resource[\"averageScore\"]);\r\n    if( item.resource.imgUrl == \"\"){item.resource.imgUrl = \"./assets/images/resources_cover/noimgCover.jpg\";}\r\n\r\n    if(starStr ==\"\" || starStr == undefined){\r\n        return `\r\n        <div class=\"row my-3 d-flex align-items-center itemRow\">\r\n            <div class=\"col-1 d-none d-xl-block\"></div>\r\n            <div class=\"col-2 col-md-1 d-flex justify-content-center\">\r\n                <span class=\"material-icons-outlined fs-7 text-yellowBrown\">push_pin</span>\r\n                <!-- <span class=\"material-icons\">push_pin</span> -->\r\n            </div>\r\n\r\n            <div class=\"col-1 d-none d-md-block\">\r\n                <a href=\"./resource.html?id=${item.resource.id}\"><img src=\"${item.resource.imgUrl}\" alt=\"\"></a>\r\n            </div>\r\n            <div class=\"col-xl-4 col-4 col-md-5 \">\r\n                <h4 class=\"fs-7\"><a href=\"./resource.html?id=${item.resource.id}\"> ${item.resource.title}</a></h4>\r\n                <div class=\"d-flex flex-wrap align-items-center\">\r\n                    <span class=\"fs-8 fw-bold text-gray me-lg-2\">尚無評論</span>\r\n                </div>\r\n            </div>\r\n            <div class=\"col-xl-4 col-6 col-md-5 \">\r\n                <div class=\"d-flex align-items-center justify-content-center flex-wrap\">\r\n                    <a href=\"${item.resource.url}\" target=\"_blank\" type=\"button\" class=\"btn btn-tiffany my-2 mx-1 \">前往資源</a>\r\n                    <a href=\"./resource.html?id=${item.resource.id}\" type=\"button\" class=\"btn btn-yellowBrown my-2  mx-1\">查看介紹</a>\r\n                    <div>\r\n                    <a role=\"button\" class=\" btn my-2 mx-1 text-yellowBrown\" >\r\n                        <span class=\"fs-6 material-icons btnRemove\" data-markId=\"${item.id}\">bookmark_remove</span></a>\r\n\r\n                   \r\n                    </div>    \r\n                </div>\r\n            </div>\r\n            <div class=\"col-1 d-none d-xl-block\"></div>\r\n        </div>`;\r\n    }else{\r\n        return `\r\n        <div class=\"row my-3 d-flex align-items-center itemRow\">\r\n            <div class=\"col-1 d-none d-xl-block\"></div>\r\n            <div class=\"col-2 col-md-1 d-flex justify-content-center\">\r\n                <span class=\"material-icons-outlined fs-7 text-yellowBrown\">push_pin</span>\r\n                <!-- <span class=\"material-icons\">push_pin</span> -->\r\n            </div>\r\n            <div class=\"col-1 d-none d-md-block\">\r\n                <a href=\"./resource.html?id=${item.resource.id}\"><img src=\"${item.resource.imgUrl}\" alt=\"\"></a>\r\n            </div>\r\n            <div class=\"col-xl-4 col-4 col-md-5 \">\r\n                <h4 class=\"fs-7\"><a href=\"./resource.html?id=${item.resource.id}\"> ${item.resource.title}</a></h4>\r\n                <div class=\"d-flex flex-wrap align-items-center text-secondary\">\r\n                    <span class=\"fs-7 fw-bold me-lg-2\"> ${(item.resource[\"averageScore\"]).toFixed(1)}</span>\r\n                    <ul class=\"d-flex align-items-center lh-1 me-lg-2\">\r\n                        ${starStr}\r\n                    </ul>                                \r\n                </div>\r\n            </div>\r\n            <div class=\"col-xl-4 col-6 col-md-5 \">\r\n                <div class=\"d-flex align-items-center justify-content-center flex-wrap\">\r\n                    <a href=\"${item.resource.url}\" type=\"button\" class=\"btn btn-tiffany my-2 mx-1 \">前往資源</a>\r\n                    <a href=\"./resource.html?id=${item.resource.id}\" type=\"button\" class=\"btn btn-yellowBrown my-2  mx-1\">查看評論</a>\r\n                    <div>\r\n                    <a  role=\"button\" class=\"btn my-2 mx-1 text-yellowBrown\">\r\n                    <span class=\"fs-6 material-icons btnRemove\" data-markId=\"${item.id}\">bookmark_remove</span></a>  \r\n                   \r\n                    </div>    \r\n                </div>\r\n            </div>\r\n            <div class=\"col-1 d-none d-xl-block\"></div>\r\n        </div>`;\r\n\r\n    }\r\n\r\n}\r\n\r\n//依分數組星星\r\nfunction combineCommentStarbyScore(score){\r\n    let starStr=\"\";\r\n\r\n    let scoreStr = score.toString();\r\n\r\n    for(let i=1; i<=scoreStr[0]*1 ;i++){\r\n      starStr+=`<li><span class=\"material-icons material-icons-sharp fs-8\">star</span></li>`;\r\n    }\r\n    \r\n    //半顆星星+空星星  \r\n    if(scoreStr[2]<=2 || scoreStr[2] == null){\r\n      for(let i=1; i<=5-(scoreStr[0]*1) ;i++){\r\n        starStr+=`<li><span class=\"material-icons material-icons-sharp fs-8\">star_outline</span></li> `;\r\n      }\r\n      \r\n    }else if(scoreStr[2]*1 >=3 && scoreStr[2]*1 <=7){\r\n        starStr+=`<li><span class=\"material-icons material-icons-sharp fs-8\">star_half</span></li>`;\r\n        for(let i=1; i<=(5-scoreStr[0]-1) ;i++){\r\n          starStr+=`<li><span class=\"material-icons material-icons-sharp fs-8\">star_outline</span></li>`;\r\n        }\r\n    }else if(scoreStr[2]*1 >=8){\r\n        starStr+=`<li><span class=\"material-icons material-icons-sharp fs-8\">star</span></li`;\r\n      for(let i=1; i<=(5-(scoreStr[0]*1)-1) ;i++){\r\n        starStr+=`<li><span class=\"material-icons material-icons-sharp fs-8\">star_outline</span></li>`;\r\n      }\r\n    }\r\n    return  starStr;\r\n}\r\n\r\n\r\n// const testButtonRemove = document.querySelector('.testButtonRemove');\r\nif(userResourcesList!==null){\r\n    userResourcesList.addEventListener(\"click\",e=>{\r\n        if(e.target.getAttribute(\"class\")==\"fs-6 material-icons btnRemove\"){\r\n            let bookmarkId = e.target.getAttribute(\"data-markId\");\r\n            //console.log(\"點擊到移除收藏按鈕\")\r\n            \r\n            Swal.fire({\r\n                title: '您確定要取消收藏嗎?',\r\n                icon: 'warning',\r\n                iconColor:\"#F8B436\",\r\n                showCancelButton: true,\r\n                confirmButtonColor: '#4AA9B6',\r\n                cancelButtonColor: '#F8B436',\r\n                confirmButtonText: '是',\r\n                cancelButtonText: '否'\r\n              }).then((result) => {\r\n\r\n                 if(result.isConfirmed) {   \r\n                    axios.delete(`https://json-server-vercel-ochre.vercel.app/bookmarks/${bookmarkId}`,headers)\r\n                    .then(res=>{\r\n                        Swal.fire({\r\n                            title:'已成功取消收藏',\r\n                            confirmButtonColor: '#4AA9B6',\r\n                        }) \r\n                        location.reload();   \r\n                        console.log(res.data);\r\n                    }).catch(err=>{\r\n                            if (err.request.status === 403) {\r\n                                document.location.href = `./acc_account.html?userid=${localStorageUserId}`;\r\n                            } else if (err?.response?.status === 401) {\r\n                                clearLocalStorage();\r\n                            };\r\n                        console.log(err);\r\n                    })   \r\n                }\r\n                \r\n              }).catch(err=>{\r\n                console.log(err);\r\n              })\r\n\r\n        }\r\n    })\r\n}\r\n   \r\n","// function initAccountResources(){\r\n//     // getAccountUserData();\r\n//     // getAccountBookmarkData();\r\n    \r\n// }\r\n// // initAccountResources();\r\n\r\n// // const userResourcesList = document.querySelector('.userResourcesList');\r\n\r\n// // //取得用戶資料\r\n// // let localStorageUserId = localStorage.getItem(\"userId\");  \r\n// // let localStorageToken = localStorage.getItem(\"accessToken\");\r\n\r\n// // // document.querySelector(\"body\").setAttribute(\"style\",\"overflow-y:hidden\");\r\n\r\n// // let userData=[];\r\n// // function getAccountUserData(){\r\n// //     axios.get(`${url}/users?id=${localStorageUserId}`)\r\n// //     .then(res=>{\r\n// //         userData = res.data;\r\n// //         document.title =\"我的資源\";\r\n// //         renderUserResList();\r\n  \r\n// //     }).catch(err=>{\r\n// //         if (err.request.status === 403) {\r\n// //             document.location.href = `/acc_resources.html?userid=${localStorageUserId}`;\r\n// //         } else if (err.request.status === 401) {\r\n// //             clearLocalStorage();\r\n// //         };\r\n// //       console.log(err);\r\n// //     })\r\n// // }\r\n\r\n\r\n\r\n// // const fileUploader = document.querySelector('#file-uploader');\r\n\r\n// // fileUploader.addEventListener('change', (e) => {\r\n// //   console.log(e.target.files); // get file object\r\n// // });\r\n\r\n// // STEP 1: select element and register change event\r\n// const imagePreview = document.querySelector('[data-target=\"image-preview\"]');\r\n// const spinner = document.querySelector('[data-target=\"spinner\"]');\r\n// const fileUploader = document.querySelector('[data-target=\"file-uploader\"]');\r\n// if(fileUploader!==null){\r\n//     fileUploader.addEventListener(\"change\", handleFileUpload);\r\n// }\r\n\r\n// async function handleFileUpload(e) {\r\n//   try {\r\n//     const file = e.target.files[0];\r\n//     setUploading(true);\r\n//     if (!file) return;\r\n\r\n//     const beforeUploadCheck = await beforeUpload(file);\r\n//     if (!beforeUploadCheck.isValid) throw beforeUploadCheck.errorMessages;\r\n\r\n//     const arrayBuffer = await getArrayBuffer(file);\r\n//     const response = await uploadFileAJAX(arrayBuffer);\r\n    \r\n//     alert(\"File Uploaded Success\");\r\n//     showPreviewImage(file);\r\n//   } catch (error) {\r\n//     alert(error);\r\n//     console.log(\"Catch Error: \", error);\r\n//   } finally {\r\n//     e.target.value = '';  // reset input file\r\n//     setUploading(false);\r\n//   }\r\n// }\r\n\r\n// // STEP 2: showPreviewImage with createObjectURL\r\n// function showPreviewImage(fileObj) {\r\n//   const image = URL.createObjectURL(fileObj);\r\n//   imagePreview.src = image;\r\n// }\r\n\r\n// // STEP 3: change file object into ArrayBuffer\r\n// function getArrayBuffer(fileObj) {\r\n//   return new Promise((resolve, reject) => {\r\n//     const reader = new FileReader();\r\n//     // Get ArrayBuffer when FileReader on load\r\n//     reader.addEventListener(\"load\", () => {\r\n//       resolve(reader.result);\r\n//     });\r\n\r\n//     // Get Error when FileReader on error\r\n//     reader.addEventListener(\"error\", () => {\r\n//       reject(\"error occurred in getArrayBuffer\");\r\n//     });\r\n\r\n//     // read the blob object as ArrayBuffer\r\n//     // if you nedd Base64, use reader.readAsDataURL\r\n//     reader.readAsArrayBuffer(fileObj);\r\n//   });\r\n// }\r\n\r\n// // STEP 4: upload file throguth AJAX\r\n// // - use \"new Uint8Array()\"\" to change ArrayBuffer into TypedArray\r\n// // - TypedArray is not a truely Array,\r\n// //   use \"Array.from()\" to change it into Array\r\n// function uploadFileAJAX(arrayBuffer) {\r\n//   // correct it to your own API endpoint\r\n//   return fetch(\"https://jsonplaceholder.typicode.com/posts/\", {\r\n//     headers: {\r\n//       version: 1,\r\n//       \"content-type\": \"application/json\"\r\n//     },\r\n//     method: \"POST\",\r\n//     body: JSON.stringify({\r\n//       imageId: 1,\r\n//       icon: Array.from(new Uint8Array(arrayBuffer))\r\n//     })\r\n//   })\r\n//     .then(res => {\r\n//       if (!res.ok) {\r\n//         throw res.statusText;\r\n//       }\r\n//       return res.json();\r\n//     })\r\n//     .then(data => data)\r\n//     .catch(err => console.log(\"err\", err));\r\n// }\r\n\r\n// // STEP 5: Create before upload checker if needed\r\n// function beforeUpload(fileObject) {\r\n//   return new Promise(resolve => {\r\n//     const validFileTypes = [\"image/jpeg\", \"image/png\"];\r\n//     const isValidFileType = validFileTypes.includes(fileObject.type);\r\n//     let errorMessages = [];\r\n\r\n//     if (!isValidFileType) {\r\n//       errorMessages.push(\"You can only upload JPG or PNG file!\");\r\n//     }\r\n\r\n//     const isValidFileSize = fileObject.size / 1024 / 1024 < 2;\r\n//     if (!isValidFileSize) {\r\n//       errorMessages.push(\"Image must smaller than 2MB!\");\r\n//     }\r\n\r\n//     resolve({\r\n//       isValid: isValidFileType && isValidFileSize,\r\n//       errorMessages: errorMessages.join(\"\\n\")\r\n//     });\r\n//   });\r\n// }\r\n\r\n// function setUploading(isUploading) {\r\n//   if (isUploading === true) {\r\n//     spinner.classList.add(\"opacity-1\");\r\n//   } else {\r\n//     spinner.classList.remove(\"opacity-1\");\r\n//   }\r\n// }\r\n\r\n\r\n","const wrapperLoading = document.querySelector('.wrapperLoading');\n\n\nfunction clearLocalStorage(){\n    localStorage.clear();\n    Swal.fire({\n        icon: 'error',\n        title: '登入逾時',\n        text: '請重新登入'\n    });\n    setTimeout(() => {\n        document.location.href = './login.html';\n    }, 2000);\n}\n\nfunction test(){\n    console.log('登出測試')\n}\nfunction displayNoneWrapper(){\n    wrapperLoading.setAttribute(\"class\",\"d-none\");\n    document.querySelector(\"body\").setAttribute(\"style\",\"\");\n    if(document.querySelector(\".loadingBG\")!==null){\n        document.querySelector(\".loadingBG\").setAttribute(\"class\",\"d-none\");\n    }\n}\n\nfunction displayBlockWrapper(){\n    document.querySelector(\"body\").setAttribute(\"style\",\"overflow-y:hidden\");\n    wrapperLoading.setAttribute(\"class\",\"d-block\");\n    document.querySelector(\"body\").setAttribute(\"style\",\"\");\n    if(document.querySelector(\".loadingBG\")!==null){\n        document.querySelector(\".loadingBG\").setAttribute(\"class\",\"d-block\");\n    }\n}\n\n","// const url=\"http://localhost:3000\";\r\nconst apiUrl=\"https://json-server-vercel-ochre.vercel.app\"\r\n","const apiUrl=\"https://json-server-vercel-ochre.vercel.app\";\r\nlet locationHref = location.href.split(\"/\");\r\nlet resTopic = location.href.split(\"=\")[1];\r\nlet resId = location.href.split(\"=\")[1];\r\nlet userId = location.href.split(\"=\")[1];\r\nlet localStorageUserId = localStorage.getItem(\"userId\");  \r\n// let pageClassify = locationHref[3].split(\".html\")[0];\r\n// let homePage = locationHref[0]+`//`+locationHref[2];\r\n\r\n\r\n//1. 頁面初始化\r\nfunction initIndex(){\r\n    getResourcesForIndex();\r\n    // if(pageClassify==\"resource\"){\r\n    //     if(resId == undefined){\r\n    //         location.href = `./index.html`;\r\n    //     }\r\n    // }\r\n    // else if(pageClassify==\"resource_list\"){\r\n    //     if(resTopic == undefined){\r\n    //         location.href = `./index.html`;\r\n    //     }\r\n    // }\r\n}\r\ninitIndex();\r\n\r\n//好評推薦\r\nconst goodRate1 = document.querySelector('#goodRate1 > div.row');\r\nconst goodRate2 = document.querySelector('#goodRate2 > div.row');\r\nconst goodRate3 = document.querySelector('#goodRate3 > div.row');\r\nconst goodRate1Tab = document.querySelector('#goodRate1-tab');\r\nconst goodRate2Tab = document.querySelector('#goodRate2-tab');\r\nconst goodRate3Tab = document.querySelector('#goodRate3-tab');\r\n\r\n//最新免費資源\r\nconst resourceType1 = document.querySelector('#resourceType1 > div.row');\r\nconst resourceType2 = document.querySelector('#resourceType2 > div.row');\r\nconst resourceType3 = document.querySelector('#resourceType3 > div.row');\r\nconst resource1Tab = document.querySelector('#resource1-tab');\r\nconst resource2Tab = document.querySelector('#resource2-tab');\r\nconst resource3Tab = document.querySelector('#resource3-tab');\r\n\r\n\r\nlet resourcesData = [];\r\nlet commentsData = [];\r\n// document.querySelector(\"body\").setAttribute(\"style\",\"overflow-y:hidden\");\r\n\r\n//取得資源資料\r\nfunction getResourcesForIndex(){\r\n  axios.get(`${apiUrl}/resources`)\r\n  .then(res=>{\r\n    resourcesData = res.data;\r\n    document.title = \"Eng!neer 程式學習資源網\";\r\n    \r\n    // displayNoneWrapper();\r\n    if(wrapperLoading!==null){\r\n        document.querySelector(\"body\").setAttribute(\"style\",\"\");\r\n        wrapperLoading.setAttribute(\"class\",\"d-none\");\r\n        document.querySelector(\"body\").setAttribute(\"style\",\"\");\r\n        if(document.querySelector(\".loadingBG\")!==null){\r\n            document.querySelector(\".loadingBG\").setAttribute(\"class\",\"d-none\");\r\n        }    \r\n    }\r\n\r\n    sortGoodRateResources(resourcesData);\r\n    renderGoodRateList();\r\n    renderNewFreeList();\r\n  \r\n  }).catch(error=>{\r\n    console.log(error);\r\n  })\r\n}\r\n\r\n\r\n//渲染好評推薦資料\r\nfunction renderGoodRateList(){\r\n    let commentScoreNum = getAverageScore();\r\n    let resultScore = commentScoreNum[0];\r\n    let commentNum = commentScoreNum[1];\r\n    let starStr = combineCommentStar(resultScore); \r\n\r\n    let itemNum1 = 0;\r\n    let itemNum2 = 0;\r\n    let itemNum3 = 0;\r\n    let renderMaxNum = 6;\r\n    let tabJS =\"\";\r\n    let tabHtml=\"\";\r\n    let tabPython=\"\";\r\n\r\n    resourcesData.forEach( (item)=>{\r\n        // console.log(\"resultScore\");\r\n        // console.log(resultScore);\r\n        switch (item.topics){\r\n            case \"JavaScript\" :\r\n                if(itemNum1 <renderMaxNum){\r\n                    tabJS += combineResouorceItemType1(item,resultScore,starStr,commentNum);\r\n                   itemNum1 +=1;\r\n                }\r\n                break;\r\n\r\n            case \"HTML/CSS\" :\r\n                if(itemNum2 < renderMaxNum){\r\n                    tabHtml += combineResouorceItemType1(item,resultScore,starStr,commentNum);\r\n                    itemNum2+=1;\r\n                }\r\n                break;\r\n\r\n            case \"Python\" :\r\n                if(itemNum3 < renderMaxNum){\r\n                     tabPython += combineResouorceItemType1(item,resultScore,starStr,commentNum);\r\n                itemNum3+=1\r\n                }\r\n               \r\n                break;\r\n        }\r\n    })\r\n\r\n    if(goodRate1 !==null ){\r\n        if(tabJS==\"\"){\r\n            goodRate1Tab.setAttribute(\"class\", \"d-none\");\r\n        }\r\n        goodRate1.innerHTML = tabJS;\r\n    }\r\n    if(goodRate2 !==null ){\r\n        if(tabHtml==\"\"){\r\n            goodRate2Tab.setAttribute(\"class\", \"d-none\");\r\n        }\r\n        goodRate2.innerHTML = tabHtml;\r\n    }\r\n    if(goodRate3 !==null ){\r\n        if(tabPython==\"\"){\r\n            goodRate3Tab.setAttribute(\"class\", \"d-none\");\r\n        }\r\n        goodRate3.innerHTML = tabPython;\r\n    }\r\n\r\n}\r\n\r\n\r\n//組單一資源項目html - type 1\r\nfunction combineResouorceItemType1(item,resultScore,starStr,commentNum){\r\n\r\n  if( item.imgUrl ===\"\"){\r\n    item.imgUrl = \"./assets/images/resources_cover/noimgCover.jpg\";\r\n  }\r\n\r\n  if(resultScore[item.id]===undefined || starStr[item.id]=== undefined || commentNum[item.id]=== undefined ){\r\n\r\n    return  `\r\n    <div class=\"col-md-6 col-lg-4\">\r\n    <div class=\"d-flex p-2 align-items-center\">\r\n        <div class=\"row\">\r\n            <div class=\"col-6\"><a href=\"./resource.html?id=${item.id}\" ><img src=\"${item.imgUrl}\" alt=\"${item.title}\" onerror=\"this.src=./assets/images/resources_cover/noimgCover.jpg\"></a></div>\r\n            \r\n            <div class=\"col-6\">\r\n                <h4 class=\"ellipsis\"><a href=\"./resource.html?id=${item.id}\" > ${item.title}</a></h4>\r\n                <div class=\"d-flex justify-content-between text-gray fs-8 align-items-center\">\r\n                尚無評價\r\n                </div>\r\n            </div>\r\n            \r\n        </div>\r\n         \r\n        \r\n    </div>\r\n    </div>\r\n    `;\r\n  }else{\r\n    return  `\r\n    <div class=\"col-md-6 col-lg-4\">\r\n    <div class=\"d-flex p-2 align-items-center\">\r\n        <div class=\"row\">\r\n            <div class=\"col-6\"><a href=\"./resource.html?id=${item.id}\" ><img src=\"${item.imgUrl}\" alt=\"${item.title}\" onerror=\"this.src=./assets/images/resources_cover/noimgCover.jpg\"></a></div>\r\n\r\n            <div class=\"col-6\">\r\n                <h4 class=\"ellipsis\"><a href=\"./resource.html?id=${item.id}\" > ${item.title}</a></h4>\r\n                <div class=\"d-flex justify-content-start align-items-center \">\r\n                    <span class=\"fs-7 fw-bold text-secondary\"> ${resultScore[item.id]}</span>\r\n                    <ul class=\"d-flex align-items-center mx-2 lh-1 text-secondary\">\r\n                    ${starStr[item.id]}\r\n                    </ul>                                \r\n                    <span class=\"fs-8 text-secondary\">(${commentNum[item.id]})</span>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        \r\n    </div>\r\n    </div>`;\r\n  }\r\n      \r\n}\r\n\r\n//渲染最新免費資源\r\nfunction renderNewFreeList(){\r\n    let commentScoreNum = getAverageScore();\r\n    let resultScore = commentScoreNum[0];\r\n    let commentNum = commentScoreNum[1];\r\n    let starStr = combineCommentStar(resultScore);\r\n\r\n\r\n    let itemNum1 = 0;\r\n    let itemNum2 = 0;\r\n    let itemNum3 = 0;\r\n    let renderMaxNum = 6;\r\n\r\n    let tabOnline =\"\";\r\n    let tabOffline=\"\";\r\n    let tabArticle=\"\";\r\n\r\n\r\n    resourcesData.forEach( (item)=>{\r\n        if(item.price===\"免費\"){\r\n            if(item.type===\"線上課程\"){\r\n                if(itemNum1 <renderMaxNum){\r\n                    tabOnline += combineResouorceItem(item,resultScore,starStr,commentNum);\r\n                    itemNum1+=1\r\n                }\r\n            }\r\n\r\n            if(item.type===\"實體課程\"){\r\n                if(itemNum2 <renderMaxNum){\r\n                    tabOffline += combineResouorceItem(item,resultScore,starStr,commentNum);\r\n                    itemNum2+=1\r\n                }\r\n            }\r\n\r\n            if(item.type===\"文章\"){\r\n                if(itemNum3 <renderMaxNum){\r\n                    tabArticle += combineResouorceItem(item,resultScore,starStr,commentNum);\r\n                    itemNum3+=1\r\n                }\r\n\r\n            }\r\n        }\r\n \r\n    })\r\n\r\n    if(resourceType1 !==null ){\r\n        resourceType1.innerHTML = tabOnline;\r\n        if(tabOnline==\"\"){\r\n            resource1Tab.setAttribute(\"class\", \"d-none\");\r\n        }\r\n    }\r\n    if(resourceType2 !==null ){\r\n        resourceType2.innerHTML = tabOffline;\r\n        if(tabOffline==\"\"){\r\n            resource2Tab.setAttribute(\"class\", \"d-none\");\r\n        }\r\n    }\r\n    if(resourceType3 !==null ){\r\n        resourceType3.innerHTML = tabArticle;\r\n        if(tabArticle==\"\"){\r\n            resource3Tab.setAttribute(\"class\", \"d-none\");\r\n        }\r\n    }\r\n\r\n\r\n\r\n}\r\n\r\n\r\nfunction sortGoodRateResources(resRenderList){\r\n   \r\n    resRenderList = resRenderList?.sort((a,b)=>{\r\n        return b.averageScore - a.averageScore;\r\n    })\r\n      return resRenderList;\r\n}","const apiUrl=\"https://json-server-vercel-ochre.vercel.app\";\r\n\r\nlet localStorageUserId = localStorage.getItem(\"userId\");\r\nlet localStorageUserToken = localStorage.getItem(\"accessToken\");\r\n\r\nconst beforeLogin = document.querySelector('.beforeLogin');\r\nconst afterLogin = document.querySelector('.afterLogin');\r\n\r\nconst accountMenuImg = document.querySelector('.accountMenuImg');\r\nconst accountMenu = document.querySelector('.accountMenu');\r\n\r\nconst logOut = document.querySelector('.logOut');\r\n\r\n\r\n\r\n\r\n//如果有取得 userid  就表示有登入\r\nif(localStorageUserId == null || localStorageUserId == \"\" ){\r\n    if(afterLogin!==null){\r\n        afterLogin.setAttribute(\"class\",\"d-none\");\r\n    }\r\n}else{\r\n    if(beforeLogin!==null){\r\n        beforeLogin.setAttribute(\"class\",\"d-none\");\r\n    }\r\n    let userData=[];\r\n    axios.get(`${apiUrl}/users?id=${localStorageUserId}`,headers).then(res=>{\r\n        userData=res.data;\r\n        renderAccountMenu(userData);\r\n       \r\n    }).catch(err=>{\r\n        if(err?.reponse?.status === 401){\r\n            clearLocalStorage();\r\n            test();\r\n        }\r\n        console.log(err);\r\n    })\r\n}\r\n\r\n\r\n//隱藏登入註冊, 顯示會員功能, 帶入相關會員資訊 , 切換至會員頁時帶入會員 id 資料等\r\n//將 userid 渲染至選單連結中\r\nfunction renderAccountMenu(userData){\r\n    if(userData.length!=0){\r\n        let prefix = (userData[0].firstName)[0].toUpperCase();\r\n    \r\n        let accountMenuImgStr=`\r\n        <span class=\"userImg d-inline-block bg-primary px-2 py-2 rounded-circle fw-bold fs-7 lh-1 text-white text-center\">${prefix}</span>`;\r\n        let accountMenuStr=`<li><a class=\"dropdown-item\" href=\"./acc_profile.html?userid=${localStorageUserId}\">個人資料</a></li>\r\n        <li><a class=\"dropdown-item\" href=\"./acc_resources.html?userid=${localStorageUserId}\">我的資源</a></li>\r\n        <li><a class=\"dropdown-item\" href=\"#\">我的募集</a></li>\r\n        <li><a class=\"dropdown-item\" href=\"#\">我的學習</a></li>\r\n        <li><a class=\"dropdown-item\" href=\"#\">設定</a></li>`;\r\n    \r\n        accountMenuImg.innerHTML=accountMenuImgStr;\r\n        accountMenu.innerHTML=accountMenuStr;\r\n\r\n    }\r\n}\r\n\r\n\r\n//如果登出,就清空 localStorage userId\r\nlogOut.addEventListener(\"click\",e=>{\r\n    localStorage.setItem('accessToken', \"\");\r\n    localStorage.setItem('userId',\"\");\r\n    if(beforeLogin!==null){\r\n            beforeLogin.setAttribute(\"class\",\"d-block\");\r\n    }\r\n    if(afterLogin!==null){\r\n        afterLogin.setAttribute(\"class\",\"d-none\");\r\n    }\r\n    location.href = \"./index.html\";\r\n    //location.reload();\r\n})\r\n\r\n","\r\nconst apiUrl=\"https://json-server-vercel-ochre.vercel.app\";\r\n\r\nconst loginAccount = document.querySelector('#loginAccount');\r\nconst loginPw = document.querySelector('#loginPw');\r\nconst btnLogin = document.querySelector('#btnLogin');\r\n// const signUpFormInputs = document.querySelectorAll('input.form-control');  //input\r\n\r\n\r\nfunction initLogin(){\r\n    getUserListbyLoginPage();\r\n}\r\ninitLogin();\r\n\r\n\r\n//取得用戶清單\r\nlet usersData = [];\r\nfunction getUserListbyLoginPage(){\r\n    axios.get(`${apiUrl}/users`).then(res=>{\r\n        usersData = res.data;\r\n    }).catch(err=>{\r\n        console.log(err);\r\n    })\r\n}\r\n\r\n//欄位檢查\r\n\r\n    if(document.querySelector(\"#loginAccount\")!==null){\r\n        document.querySelector(\"#loginAccount\").addEventListener(\"change\",e=>{\r\n            document.querySelector('.account').textContent=\"\";\r\n            if(loginAccount.value==\"\"){\r\n                document.querySelector('.account').textContent=\"請輸入帳號\";\r\n            }else{\r\n                document.querySelector('.account').textContent=\"\";\r\n            }\r\n            \r\n            let result = usersData.filter(userItem=>{\r\n                return userItem.email === loginAccount.value;\r\n            })\r\n            // console.log(\"result\");\r\n            // console.log(result);\r\n            if(result.length==0){\r\n                document.querySelector('.account').textContent=\"此帳號不存在\";\r\n            }\r\n\r\n           \r\n            })\r\n    }\r\n    if(document.querySelector(\"#loginPw\")!==null){\r\n        document.querySelector(\"#loginPw\").addEventListener(\"change\",e=>{\r\n            document.querySelector('.password').textContent=\"\";\r\n            if(loginPw.value==\"\"){\r\n                document.querySelector('.password').textContent=\"請輸入密碼\";\r\n            }else{\r\n                document.querySelector('.password').textContent=\"\";\r\n            }\r\n        })\r\n    }\r\n\r\n    \r\n\r\n    if(btnLogin!==null){\r\n\r\n    btnLogin.addEventListener(\"click\",e=>{\r\n    e.preventDefault();\r\n\r\n        if(loginAccount.value===\"\"||loginPw.value===\"\"){\r\n            return\r\n        }\r\n\r\n        if(document.querySelector('.account').textContent==\"\" && \r\n        document.querySelector('.password').textContent==\"\" ){\r\n\r\n            axios.post(\"https://json-server-vercel-ochre.vercel.app/login\",{\r\n                \"email\":loginAccount.value,\r\n                \"password\":loginPw.value\r\n\r\n            }).then(res=>{\r\n                localStorage.setItem('accessToken', `${res.data.accessToken}`);\r\n                localStorage.setItem('userId', res.data.user.id);\r\n                location.href = \"./index.html\";\r\n\r\n            }).catch(err=>{\r\n                document.querySelector('.password').textContent=\"密碼錯誤\";\r\n                localStorage.clear();\r\n                \r\n            })\r\n\r\n        }\r\n\r\n\r\n    })\r\n    }   \r\n\r\n\r\n\r\n","const apiUrl=\"https://json-server-vercel-ochre.vercel.app\";\r\n\r\nlet resId = parseFloat(location.href.split(\"=\")[1]);\r\nlet headers = {\r\n    headers:{\r\n        \"authorization\": `Bearer ${localStorageToken}` \r\n    }\r\n}\r\n\r\nfunction initResourcePage(){\r\n    getResourcesForResources();\r\n    getCommentData();\r\n    getResourcesItem(resId);\r\n    getResourcesComment(resId);\r\n\r\n    getUserData();\r\n    getbookmarkData();\r\n    //submitComment();\r\n}\r\ninitResourcePage();\r\n\r\nlet resourcesData = [];\r\nlet commentsData = [];\r\n\r\n// 取得所有資源資料\r\nfunction getResourcesForResources(){\r\n  axios.get(`${apiUrl}/resources`)\r\n  .then(res=>{\r\n    resourcesData = res.data; \r\n  }).catch(error=>{\r\n    console.log(error);\r\n  })\r\n}\r\n\r\nfunction getCommentData(){\r\n  axios.get(`${apiUrl}/comments`)\r\n  .then(res=>{\r\n    commentsData = res.data; \r\n    renderRelatedResource();\r\n  }).catch(error=>{\r\n    console.log(error);\r\n    \r\n  })\r\n}\r\n\r\n\r\nlet resourceContent=[];\r\nlet resourceCommentData=[];\r\n\r\n//取得單一資源\r\nfunction getResourcesItem(id){\r\n    axios.get(`${apiUrl}/resources?id=${id}&_expand=user`)\r\n    .then(res=>{\r\n        resourceContent = res.data;\r\n        renderResource();\r\n        renderRelatedResource();\r\n    \r\n    }).catch(error=>{\r\n      console.log(error);\r\n    })\r\n}\r\nfunction getResourcesComment(id){\r\n    axios.get(`${apiUrl}/comments?_expand=resouceId&&resourceId=${id}&&_expand=user`)\r\n    .then(res=>{\r\n        resourceCommentData = res.data;\r\n        renderResource();\r\n        renderComment();\r\n        submitComment();\r\n\r\n    }).catch(error=>{\r\n      console.log(error);\r\n    })\r\n}\r\n\r\n/******************資源資訊***********************/\r\n\r\nconst imageNBrief = document.querySelector('.imageNBrief');\r\nconst titleBox = document.querySelector('.titleBox');\r\nconst btnResLink = document.querySelector('.btnResLink');\r\n\r\n\r\nfunction renderResource(){\r\n\r\n    let renderItem=resourceContent[0];\r\n    let userName =\"\";\r\n\r\n    if(renderItem!==undefined){\r\n        document.title = renderItem.title;\r\n        if( renderItem.user.role===\"admin\"){\r\n            userName = \"admin\"\r\n        }else{\r\n            userName =`${renderItem.user.lastName} ${renderItem.user.firstName} `;\r\n        }\r\n\r\n        let commentScoreNum = getAverageScore();\r\n        let resultScore = commentScoreNum[0];\r\n        let commentNum = commentScoreNum[1];\r\n        let starStr = combineCommentStar(resultScore);\r\n\r\n        let imageNBriefStr=\"\";\r\n        let titleBoxStr=\"\";\r\n        let btnBoxStr=\"\";\r\n\r\n        if( renderItem.imgUrl ===\"\"){\r\n            renderItem.imgUrl = \"./assets/images/resources_cover/noimgCover.jpg\";\r\n        }\r\n\r\n        if(resultScore[resId]===undefined || starStr[resId]=== undefined ){\r\n            titleBoxStr = `<h2 class=\"fs-5 fw-bold mt-md-0 mt-3\">${renderItem.title}</h2>\r\n            <div class=\"d-flex flex-wrap align-items-center text-secondary\">\r\n                <span class=\"fs-8 fw-bold me-lg-2\">尚無評價</span>\r\n            </div>\r\n            <div class=\"classify fs-7\">\r\n                <ul class=\"d-flex \">\r\n                    <li class=\"me-2\">  ${renderItem.topics}</li>\r\n                    <li class=\"me-2\">  ${renderItem.type}</li>\r\n                    <li class=\"me-2\">  ${renderItem.level}</li>\r\n                    <li class=\"me-2\">  ${renderItem.price}</li>\r\n                </ul>\r\n                <ul>\r\n                    <li class=\"me-2\">  ${renderItem.lang} </li>\r\n                    <li class=\"me-2\">建立者 : ${userName} </li>\r\n                </ul>\r\n            </div>`;\r\n        }else{\r\n            titleBoxStr = `<h2 class=\"fs-5 fw-bold mt-md-0 mt-3\">${renderItem.title}</h2>\r\n            <div class=\"d-flex flex-wrap align-items-center text-secondary\">\r\n                <span class=\"fs-5 fw-bold me-lg-2\"> ${resultScore[resId]}</span>\r\n                <ul class=\"d-flex align-items-center lh-1 me-lg-2\">\r\n                ${starStr[resId]}\r\n                </ul>                                \r\n                <span class=\"fs-8\">(${commentNum[resId]})</span>\r\n            </div>\r\n            <div class=\"classify fs-7\">\r\n                <ul class=\"d-flex \">\r\n                    <li class=\"me-2\">  ${renderItem.topics}</li>\r\n                    <li class=\"me-2\">  ${renderItem.type}</li>\r\n                    <li class=\"me-2\">  ${renderItem.level}</li>\r\n                    <li class=\"me-2\">  ${renderItem.price}</li>\r\n                </ul>\r\n                <ul>\r\n                    <li class=\"me-2\">  ${renderItem.lang} </li>\r\n                    <li class=\"me-2\">建立者 : ${userName} </li>\r\n                </ul>\r\n            </div>`;\r\n        }\r\n\r\n        \r\n        btnBoxStr = `\r\n        <a href=\"${renderItem.url}\" type=\"button\" target=\"_blank\" class=\"btn btn-secondary my-2 text-white px-lg-4 py-2 fs-6 w-100\">前往資源</a>`;\r\n\r\n        imageNBriefStr = `\r\n        <img class=\"d-md-block\" src=\"${renderItem.imgUrl}\" alt=\"${renderItem.title}\">\r\n                    <div class=\"mt-md-3 text-dark\">${renderItem.intro}</div>`;\r\n        \r\n        \r\n        if(imageNBrief!==null){\r\n            imageNBrief.innerHTML = imageNBriefStr;\r\n        }\r\n        if(titleBox!==null){\r\n            titleBox.innerHTML = titleBoxStr;\r\n        }\r\n        if(btnResLink!==null){\r\n            btnResLink.innerHTML = btnBoxStr;\r\n        }\r\n\r\n    }\r\n   \r\n}\r\n\r\n\r\n/******************資源評論***********************/\r\n\r\nconst commentList=document.querySelector('.resourceComment > .commentList');\r\nconst commentSort=document.querySelector('#commentSort');\r\n\r\n\r\nfunction renderComment(){\r\n\r\n    let commentStr=\"\";\r\n    let userName =\"\";\r\n    // console.log(resourceCommentData)\r\n\r\n    if(resourceCommentData.length===0){\r\n        const btnReadMore = document.querySelector('.btnReadMore');\r\n        if(btnReadMore!==null){\r\n            btnReadMore.setAttribute(\"class\",\"d-none\");\r\n        }\r\n    }\r\n    //let resultScore = getAverageScore();\r\n    let commentNum = 0;\r\n    resourceCommentData.forEach(item=>{\r\n        let resultScore = {\r\n            \"1\":`${item.score}`\r\n        };\r\n        let newResultScoreOjb = combineCommentStar(resultScore);\r\n\r\n        if(item.user.role===\"admin\"){\r\n            userName = \"admin\"\r\n        }else{\r\n            userName =`${item.user.firstName} ${item.user.lastName}`;\r\n        }\r\n\r\n        let prefix = (item.user.firstName)[0].toUpperCase();\r\n        let commentTimeAge = Ftime(item.commentTime);\r\n        commentStr+=`\r\n        <div class=\"col mb-3 position-relatvie\" style=\"z-index:10;\">\r\n            <div class=\"card card-body position-relatvie d-flex justify-content-between\" style=\"z-index:10;\">\r\n                <div class=\"d-flex align-items-lg-center flex-column flex-lg-row justify-content-between\"> \r\n                    <h3 class=\"card-title fs-7 d-flex align-items-center justify-content-lg-start justify-content-between\">\r\n\r\n                        <span class=\"userImg d-inline-block bg-primary px-2 py-2 rounded-circle fw-bold fs-7 lh-1 text-white text-center\">${prefix}</span>\r\n\r\n                        <p class=\"mb-0 mx-2 text-start\">\r\n                            ${userName}<br/>\r\n                            <span class=\"fs-9 text-gray\">${item.user.title}</span>\r\n                        </p>\r\n                        \r\n                    </h3>\r\n                    <div class=\"d-flex flex-lg-column justify-content-between\">\r\n                        <ul class=\"card-text d-flex align-items-center lh-1\">\r\n                        ${newResultScoreOjb[1]}\r\n                        \r\n                        </ul> \r\n                        <p class=\"mb-0 text-end\">\r\n                            <span class=\"fs-9 text-gray\">${commentTimeAge}</span></p>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class=\"d-flex flex-column\">\r\n                    <div class=\"form-floating my-3\"> \r\n                        <p>${item.content}</p>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class=\"d-flex justify-content-between fs-8\">\r\n                    <!-- like & dislike -->\r\n                    <div class=\"d-flex align-items-center\">\r\n                        <a href=\"#\">\r\n                            <span class=\"material-icons-outlined fs-6\">thumb_up_alt</span></a>\r\n                        <span class=\"mx-2\">${item.likeNum}</span>\r\n                        <!-- <a href=\"#\">\r\n                        <span class=\"material-icons fs-6\">thumb_up_alt</span></a> -->\r\n\r\n                            <a href=\"#\">\r\n                            <span class=\"material-icons-outlined fs-6\">thumb_down_alt</span></a>\r\n                            <span class=\"mx-2\">${item.dislikeNum}</span>\r\n                            <!-- <a href=\"#\">\r\n                            <span class=\"material-icons fs-6\">thumb_down_alt</span></a> -->\r\n\r\n                    </div>\r\n\r\n                    <div class=\"position-relatvie\" >\r\n                        <a class=\"d-flex align-items-center\" data-bs-toggle=\"collapse\" href=\"#commentOffense${commentNum+1}\" role=\"button\" aria-expanded=\"false\" aria-controls=\"commentOffense\">\r\n                            <span class=\"material-icons-outlined\">report</span>\r\n                            <span>檢舉</span>\r\n                        </a>\r\n\r\n                        <div class=\"offenseItem border bg-light rounded-3 p-3 collapse position-absolute end-0\" id=\"commentOffense${commentNum+1}\" style=\"z-index:0;\">\r\n                            <div class=\"form-check\">\r\n                                <input class=\"form-check-input\" type=\"radio\" name=\"offenseItem\" id=\"offenseItem1\">\r\n                                <label class=\"form-check-label\" for=\"offenseItem1\">\r\n                                    偏離主題\r\n                                </label>\r\n                            </div>\r\n                            <div class=\"form-check\">\r\n                                <input class=\"form-check-input\" type=\"radio\" name=\"offenseItem\" id=\"offenseItem2\">\r\n                                <label class=\"form-check-label\" for=\"offenseItem2\">\r\n                                    垃圾內容及廣告宣傳\r\n                                </label>\r\n                            </div>\r\n                            <div class=\"form-check\">\r\n                                <input class=\"form-check-input\" type=\"radio\" name=\"offenseItem\" id=\"offenseItem3\">\r\n                                <label class=\"form-check-label\" for=\"offenseItem3\">\r\n                                    騷擾內容及不雅用語\r\n                                </label>\r\n                            </div>\r\n                            <button class=\"btn btn-primary btn-sm text-white\" type=\"submit\">送出</button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div><!--end card-->\r\n        </div>`;\r\n\r\n        commentNum +=1;\r\n\r\n    })\r\n\r\n    if(commentList!==null){\r\n         commentList.innerHTML = commentStr;\r\n    }\r\n    if(commentStr==\"\"){\r\n        if(commentSort!==null){\r\n            commentSort.setAttribute(\"class\",\"d-none\");\r\n            commentList.innerHTML = `<div class=\"text-center\">目前尚無評論，歡迎您留言分享寶貴的經驗唷!</div>`;\r\n        }\r\n\r\n    }\r\n\r\n}\r\n\r\n\r\n/******************相關資源***********************/\r\n\r\nconst relatedResource = document.querySelector('.relatedResource');\r\nconst relatedTitle = document.querySelector('h3.relatedTitle');\r\n\r\n\r\nfunction renderRelatedResource(){\r\n    let relatedStr=\"\";\r\n    let renderNum = 1;\r\n\r\n    let commentScoreNum = getAverageScore();\r\n    let resultScore = commentScoreNum[0];\r\n    let commentNum = commentScoreNum[1];\r\n    let starStr = combineCommentStar(resultScore);\r\n    \r\n    if(resourcesData!==undefined){\r\n        resourcesData.forEach(resItem=>{\r\n        // let resultScore = getAverageScore();\r\n        // let newResultScoreOjb = combineCommentStar(resultScore);\r\n\r\n        if(resourceContent.length!==0){\r\n            //console.log(resourceContent);\r\n            if(resItem.topics === resourceContent[0].topics \r\n                && resItem.id !== resourceContent[0].id){\r\n                renderNum +=1;   \r\n                if(renderNum <=5 ){\r\n                    if(resultScore[resItem.id]==undefined||starStr[resItem.id]==undefined || commentNum[resItem.id] == undefined){\r\n                        relatedStr+=`\r\n                        <div class=\"my-4\">\r\n                        <h4 class=\"fs-7\"><a href=\"./resource.html?id=${resItem.id}\" > ${resItem.title}</a></h4>\r\n                            <div class=\"d-flex flex-wrap justify-content-start align-items-center\">\r\n                                <span class=\"fs-8 text-gray me-lg-2\">尚無評價</span>                           \r\n                            </div>\r\n                        </div>\r\n                        `;\r\n                    }else{\r\n                        relatedStr+=`\r\n                        <div class=\"my-4\">\r\n                        <h4 class=\"fs-7\"><a href=\"./resource.html?id=${resItem.id}\"> ${resItem.title}</a></h4>\r\n                        <div class=\"d-flex flex-wrap justify-content-start align-items-center text-secondary\">\r\n                            <span class=\"fs-7 fw-bold me-lg-2\">${resultScore[resItem.id]}</span>\r\n                            <ul class=\"d-flex align-items-center lh-1 me-lg-2 \">\r\n                            ${starStr[resItem.id]}\r\n                            </ul>   \r\n                            <span class=\"fs-8\">(${commentNum[resItem.id]})</span>                             \r\n                        </div>\r\n                        </div>\r\n                        `;\r\n                    }\r\n                \r\n                    \r\n                } \r\n            }\r\n        }\r\n        \r\n        \r\n        })\r\n    }\r\n    \r\n\r\n    if(relatedResource!==null){\r\n        relatedResource.innerHTML = relatedStr;\r\n    }\r\n    if(relatedTitle!==null){\r\n        if(relatedStr==\"\"){\r\n            relatedTitle.setAttribute(\"class\",\"d-none\");\r\n        }\r\n    }\r\n}\r\n\r\n\r\n/******************立即評論***********************/\r\n\r\nconst btnComment = document.querySelector('.btnComment');\r\nconst commentContent = document.querySelector('.commentContent');\r\nconst userInfo = document.querySelector('h3.userInfo');\r\nconst btnCommentSubmit = document.querySelector('.btnCommentSubmit');\r\n\r\nconst commentStar = document.querySelectorAll('.commentStar > li > a >span');\r\nconst commentTextarea = document.querySelector('#commentTextarea');\r\nconst btnBookmark = document.querySelector('.btnBookmark');\r\n\r\n\r\n//取得該用戶資料\r\nlet localStorageUserId = localStorage.getItem(\"userId\");  \r\nlet localStorageToken = localStorage.getItem(\"accessToken\");\r\n\r\nlet userData=[];\r\n// document.querySelector(\"body\").setAttribute(\"style\",\"overflow-y:hidden\");\r\n\r\nfunction getUserData(){\r\n    axios.get(`${apiUrl}/users?id=${localStorageUserId}`)\r\n    .then(res=>{\r\n        userData = res.data;\r\n        renderBtnCommentContent();\r\n  \r\n    }).catch(error=>{\r\n        if(error?.response?.status==401){\r\n            clearLocalStorage();\r\n        }\r\n      console.log(error);\r\n    })\r\n}\r\n\r\nlet userBookmark;\r\nfunction getbookmarkData(){\r\n    axios.get(`${apiUrl}/bookmarks?userId=${localStorageUserId}`)\r\n    .then(res=>{\r\n        userBookmark = res.data;        \r\n        renderBookmark();\r\n  \r\n    }).catch(error=>{\r\n        console.log(error);\r\n        if(error?.response?.status==401){\r\n            clearLocalStorage();\r\n        }\r\n        \r\n    })\r\n}\r\n\r\n//渲染按鈕 //更新 collapseComment   判斷是否有\"收藏\"\r\nfunction renderBtnCommentContent(){\r\n    //console.log(localStorageUserId,localStorageToken);\r\n    if(btnComment!==null){\r\n        btnComment.setAttribute(\"href\",`#collapseComment${resId}`);\r\n        btnComment.setAttribute(\"aria-controls\",`collapseComment${resId}`);\r\n    }\r\n    if(commentContent!==null){\r\n        commentContent.setAttribute(\"id\",`collapseComment${resId}`);\r\n    }\r\n\r\n    // console.log(\"resId\");\r\n    // console.log(resId);\r\n\r\n    //如果有登入\r\n    let userInfoStr=\"\";\r\n    if(localStorageUserId !==\"\" && localStorageUserId !== null){\r\n        let prefix = (userData[0].firstName)[0].toUpperCase();\r\n        \r\n        userInfoStr=`\r\n        <span class=\"userImg d-inline-block bg-primary px-2 py-2 rounded-circle fw-bold fs-7 lh-1 text-white text-center\">${prefix}</span>\r\n        <p class=\"mb-0 mx-2 text-start\">\r\n            ${userData[0].firstName} ${userData[0].lastName}<br/>\r\n            <span class=\"fs-9 text-gray\">${userData[0].title}</span>\r\n\r\n        </p>`;\r\n\r\n        if(userInfo!==null){\r\n            userInfo.innerHTML = userInfoStr;\r\n        }\r\n\r\n    }else{\r\n        if(commentContent!==null){\r\n           commentContent.setAttribute(\"class\",\"d-none\");\r\n\r\n        }\r\n        if(btnComment!==null){\r\n            btnComment.setAttribute(\"href\",``); \r\n            btnComment.addEventListener(\"click\",e=>{\r\n            //alert(\"請先登入\");\r\n                Swal.fire({\r\n                    text:`請先登入`,\r\n                    icon: 'info',\r\n                    iconColor:\"#4AA9B6\",            \r\n                    confirmButtonColor:\"#4AA9B6\",   \r\n                })\r\n            //location.href=\"./login.html\"\r\n            })\r\n        }\r\n    }\r\n}\r\n\r\nfunction renderBookmark(){\r\n    if(localStorageUserId !==\"\" && localStorageUserId !== null){\r\n        //console.log(resId);\r\n        \r\n        let result = userBookmark.filter(item=>{\r\n            return item.resourceId == resId;\r\n        }) \r\n        //console.log(result);\r\n\r\n        if(result.length!==0){\r\n            if(btnBookmark!==null){\r\n                btnBookmark.innerHTML = `<span class=\"material-icons text-secondary\">bookmark</span>\r\n                <span class=\"text-secondary\">收藏</span>`;\r\n            }\r\n        }\r\n        \r\n        if(btnBookmark!=null){\r\n            btnBookmark.addEventListener(\"click\",e=>{\r\n                //如果已收藏 會取消收藏 delete bookmarks\r\n                if(result.length!==0){\r\n                    //console.log(result[0].id);\r\n                    axios.delete(`${apiUrl}/bookmarks/${result[0].id}`,headers)\r\n                    .then(res=>{\r\n                        btnBookmark.innerHTML = `<span class=\"material-icons\">bookmark_border</span>\r\n                        <span>收藏</span>`;\r\n                    \r\n                        location.reload();\r\n                    }).catch(err=>{\r\n                        if (err?.response?.status === 401) {\r\n                            clearLocalStorage();\r\n                        };\r\n                        console.log(err);\r\n                    })      \r\n                }else if(result.length == 0){ //如果尚未收藏  會加入收藏  post bookmarks\r\n                    axios.post(`${apiUrl}/600/bookmarks?userId=${localStorageUserId}`,{  \r\n                        \"resourceId\": resId,\r\n                        \"userId\": localStorageUserId,\r\n                        \"isFixedTop\": false\r\n                    },headers)\r\n                    .then(res=>{\r\n                        btnBookmark.innerHTML = `<span class=\"material-icons text-secondary\">bookmark</span>\r\n                        <span class=\"text-secondary\">收藏</span>`;\r\n                        location.reload();\r\n                        //console.log(res.data);\r\n                    }).catch(err=>{\r\n                        console.log(err);\r\n                        if (err?.response?.status === 401) {\r\n                            clearLocalStorage();\r\n                        };\r\n                    })\r\n                }\r\n            })\r\n        }\r\n    }else{\r\n        if(btnBookmark!=null){\r\n            btnBookmark.addEventListener(\"click\",e=>{\r\n                //alert(\"請先登入\");\r\n                Swal.fire({\r\n                    text:`請先登入`,\r\n                    icon: 'info',\r\n                    iconColor:\"#4AA9B6\",            \r\n                    confirmButtonColor:\"#4AA9B6\",   \r\n                    // showConfirmButton: false,\r\n                    timer: 1500\r\n                })\r\n                // location.href=\"./login.html\";\r\n                //setTimeout(\"location.href='./login.html'\",4000);\r\n            })\r\n\r\n        }\r\n    }\r\n}\r\n\r\nlet thisTime = ((Date.now())/1000).toFixed(0);\r\n// console.log(\"thisTime\");\r\n// console.log(thisTime);\r\n\r\nlet starNum = 0;\r\n//checked 星星\r\n// console.log(commentStar);\r\ncommentStar.forEach((starItem,index)=>{\r\n    starItem.addEventListener(\"click\",e=>{\r\n        \r\n        for(let i=0 ; i<= commentStar.length-1 ; i++){\r\n            commentStar[i].textContent = \"star_outline\"\r\n            starNum =0;\r\n        }\r\n\r\n        for(let i=0 ; i<= index ; i++){\r\n            commentStar[i].textContent = \"star\";\r\n            starNum +=1;\r\n        }\r\n        // console.log(\"starNum\");\r\n        // console.log(starNum);\r\n\r\n    })\r\n  \r\n})\r\n\r\n//檢查留言字數\r\nif(commentTextarea!==null){\r\n    commentTextarea.addEventListener(\"change\",e=>{\r\n        if( commentTextarea.value.length < 20){\r\n            document.querySelector('.commentTextarea').textContent =\"字數須超過20字\"\r\n            return;\r\n        }else{\r\n            document.querySelector('.commentTextarea').textContent =\"\";\r\n        }\r\n    \r\n    })\r\n}\r\n\r\n//送出評論, 要更新總評分\r\nfunction submitComment(){\r\n    // console.log(\"resourceCommentData\");\r\n    // console.log(resourceCommentData);\r\n    let totalScore = 0;\r\n    resourceCommentData.forEach(item=>{\r\n        totalScore += item.score;\r\n    })\r\n    let thisResAverageScore = totalScore/resourceCommentData.length;\r\n    // console.log(\"thisResAverageScore\");\r\n    // console.log(thisResAverageScore);\r\n\r\n\r\n    if(btnCommentSubmit!=null){\r\n    btnCommentSubmit.addEventListener(\"click\",e=>{\r\n        if(commentTextarea.value==\"\" ){\r\n            Swal.fire({\r\n                text:\"請填寫評價內容\",\r\n                icon: 'info',\r\n                iconColor:\"#4AA9B6\", \r\n                confirmButtonColor:\"#4AA9B6\",       \r\n                showConfirmButton: true,\r\n            })\r\n        }\r\n        if(starNum==0 ){\r\n            Swal.fire({\r\n                text:\"請給予評分\",\r\n                icon: 'info',\r\n                iconColor:\"#4AA9B6\", \r\n                confirmButtonColor:\"#4AA9B6\",       \r\n                showConfirmButton: true,\r\n            })\r\n        }\r\n        \r\n        if(commentTextarea.value!==\"\" && commentTextarea.value.length >= 20 && starNum!==0){\r\n            axios.post(`${apiUrl}/600/comments/`,{\r\n                \"resourceId\": resId,\r\n                \"userId\": localStorageUserId,\r\n                \"commentTime\": thisTime,\r\n                \"score\": starNum,\r\n                \"content\": commentTextarea.value,\r\n                \"likeNum\": 0,\r\n                \"dislikeNum\": 0\r\n            },headers).then(res=>{\r\n    \r\n                let newAverageScore ;\r\n                if(thisResAverageScore == NaN || resourceCommentData.length==0){\r\n                    newAverageScore = starNum;\r\n                }else{\r\n                    newAverageScore = ((thisResAverageScore*resourceCommentData.length)+starNum)/(resourceCommentData.length+1).toFixed(1);\r\n                } \r\n                axios.patch(`${apiUrl}/resources/${resId}`,{\r\n                    \"averageScore\":newAverageScore\r\n                })\r\n                .then(res=>{\r\n                    console.log(res.data);\r\n                }).catch(err=>{\r\n                    console.log(err);\r\n                })\r\n    \r\n                location.reload();\r\n    \r\n    \r\n            }).catch(err=>{\r\n                console.log(err);\r\n                if (err?.response?.status === 401) {\r\n                    clearLocalStorage();\r\n                };\r\n            })\r\n        }\r\n\r\n        \r\n    \r\n    })\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n/******************收藏資源***********************/\r\n","const apiUrl=\"https://json-server-vercel-ochre.vercel.app\";\n\n\n//1. 頁面初始化\nfunction initResourceList(){\n  getResourcesForResources();\n  getCommentData();\n}\ninitResourceList();\n\n\n/*****************top ***************/\n\nconst bannerBlockTitle = document.querySelector('.bannerBlock > h2');\n\nif(resTopic!==undefined && bannerBlockTitle!==null){\n  bannerBlockTitle.textContent = resTopic;\n\n}\n\n/*****************入門推薦 ***************/\n\nconst foundation1Basic = document.querySelector('#foundation1Basic > div.row');\nconst foundation2Free = document.querySelector('#foundation2Free > div.row');\nconst foundation3CN = document.querySelector('#foundation3CN > div.row');\n\nlet resourcesData = [];\nlet commentsData = [];\nlet thisTopicData = [];\n\n//2. 取得資料\nfunction getResourcesForResources(){\n  axios.get(`${apiUrl}/resources`)\n  .then(res=>{\n    resourcesData = res.data.filter(item=>{\n      return item.topics == resTopic;\n    })\n    renderFoundationRecommond();\n    renderFilterResultList();\n    sortResourcesList();\n\n  }).catch(error=>{\n    console.log(error);\n  })\n}\n\nfunction getCommentData(){\n  axios.get(`${apiUrl}/comments`)\n  .then(res=>{\n    commentsData = res.data; \n  }).catch(error=>{\n    console.log(error);\n  })\n}\n\n\n//3. 渲染入門推薦資料\nfunction renderFoundationRecommond(){\n\n  let commentScoreNum = getAverageScore();\n  let resultScore = commentScoreNum[0];\n  let commentNum = commentScoreNum[1];\n  let starStr = combineCommentStar(resultScore); //newResultScore\n\n  let itemNum1 = 0;\n  let itemNum2 = 0;\n  let itemNum3 = 0;\n  let renderMaxNum = 6;\n  //組各tab render HTML\n  let basicStr =\"\";\n  let freeStr=\"\";\n  let cnStr=\"\";\n\n  resourcesData.forEach( (item,index)=>{\n    \n   \n      if(item.level === \"初階\"){\n        if(itemNum1 <renderMaxNum){\n           basicStr += combineResouorceItem(item,resultScore,starStr,commentNum);\n           itemNum1+=1;\n        }\n         \n      }\n      \n      if(item.price === \"免費\"){\n        if(itemNum2 <renderMaxNum){\n          freeStr += combineResouorceItem(item,resultScore,starStr,commentNum); \n          itemNum2+=1;\n        }\n         \n      }\n      \n      item.lang.forEach(langItem=>{\n        if(langItem === \"繁體中文\"){\n          if(itemNum3 <renderMaxNum){\n            cnStr += combineResouorceItem(item,resultScore,starStr,commentNum);\n            itemNum3+=1;\n          }\n          \n        }\n      })\n    \n  })\n\n  if(foundation1Basic!==null){\n    document.title = resTopic;\n    foundation1Basic.innerHTML = basicStr;\n  }\n  \n  if(foundation2Free!==null){\n    document.title = resTopic;\n    foundation2Free.innerHTML = freeStr;\n  }\n  \n  if(foundation3CN!==null){\n    document.title = resTopic;\n    foundation3CN.innerHTML = cnStr;\n  }\n}\n\n\nfunction getAverageScore(){\n\nlet scoreTotal = {};  //每筆資源評價 總分\nlet resourceIdObj = {}; //每筆資源評價 筆數\nlet resultScore = {};  //每筆資源 平均分數(星星數)\n\n  commentsData.forEach(item=>{\n      if(resourceIdObj[item.resourceId] === undefined){\n          resourceIdObj[item.resourceId] = 1;\n          scoreTotal[item.resourceId] = item.score;\n         \n      }else{\n          resourceIdObj[item.resourceId] +=1;\n          scoreTotal[item.resourceId] += item.score;\n          \n      }\n      resultScore[item.resourceId] = (scoreTotal[item.resourceId] /  resourceIdObj[item.resourceId]).toFixed(1);\n\n  })\n  // console.log(\"resourceIdObj\",resourceIdObj);\n  // console.log(\"scoreTotal\",scoreTotal);\n  // console.log(\"resultScore\",resultScore);\n  return [resultScore,resourceIdObj];\n}\n\n//4. 組星星字串\nfunction combineCommentStar(resultScore){\n  //評論分數+星星+筆數 HTML\n  let newResultScore = {...resultScore};\n  let resourceIdArr = Object.keys(newResultScore);  //['1, '2, '3'] \n  let scoreArr = Object.values(newResultScore); //['4.0', '3.3', '4.5' ,'2.8'] \n\n  scoreArr.forEach((item,index)=>{\n    let starStr=\"\"; //星星HTML String\n    //星星數\n    for(let i=1; i<=item[0] ;i++){\n      starStr+=`<li><span class=\"material-icons material-icons-sharp fs-8\">star</span></li>`;\n      newResultScore[`${resourceIdArr[`${index}`]}`] = starStr;\n    }\n    \n    //半顆星星+空星星  \n      if(item[2]<=2){\n        for(let i=1; i<=(5-item[0]) ;i++){\n          starStr+=`<li><span class=\"material-icons material-icons-sharp fs-8\">star_outline</span></li> `;\n          newResultScore[`${resourceIdArr[`${index}`]}`] = starStr;\n        }\n        \n      }else if(item[2] >=3 && item[2] <=7){\n          starStr+=`<li><span class=\"material-icons material-icons-sharp fs-8\">star_half</span></li>`;\n          for(let i=1; i<=(5-item[0]-1) ;i++){\n            starStr+=`<li><span class=\"material-icons material-icons-sharp fs-8\">star_outline</span></li>`;\n          }\n          newResultScore[`${resourceIdArr[`${index}`]}`] = starStr;\n       \n      }else if(item[2]>=8){\n          starStr+=`<li><span class=\"material-icons material-icons-sharp fs-8\">star</span></li`;\n        for(let i=1; i<=(5-item[0]-1) ;i++){\n          starStr+=`<li><span class=\"material-icons material-icons-sharp fs-8\">star_outline</span></li>`;\n          newResultScore[`${resourceIdArr[`${index}`]}`] = starStr;\n        }\n      }\n\n  })\n  return newResultScore;\n}\n\n\n\n//5. 入門推薦組單一資源項目html\nfunction combineResouorceItem(item,resultScore,starStr,commentNum){\n\n  if( item.imgUrl ===\"\"){\n    item.imgUrl = \"./assets/images/resources_cover/noimgCover.jpg\";\n  }\n\n  if(resultScore[item.id]===undefined || starStr[item.id]=== undefined || commentNum[item.id]=== undefined ){\n\n    return  `\n    <div class=\"col-lg-2 col-md-4 col-6\">\n    <div>\n        <p class=\"text-center\">\n            <a href=\"./resource.html?id=${item.id}\" >\n            <img src=\"${item.imgUrl}\" alt=\"${item.title}\" onerror=\"this.src=./assets/images/resources_cover/noimgCover.jpg\"></a></p>\n        <div class=\"p-2\">\n            <h4 class=\"fs-7 ellipsis\"><a href=\"./resource.html?id=${item.id}\" > ${item.title}</a></h4>\n            <div class=\"d-flex flex-wrap justify-content-between align-items-center\">                             \n                <span class=\"fs-8 text-gray\"> 尚無評價 </span>\n            </div>\n  \n        </div>\n    </div>\n    </div>\n    `;\n  }else{\n    return  `\n      <div class=\"col-lg-2 col-md-4 col-6\">\n      <div>\n          <p class=\"text-center\">\n              <a href=\"./resource.html?id=${item.id}\" >\n              <img src=\"${item.imgUrl}\" alt=\"${item.title}\" onerror=\"this.src=./assets/images/resources_cover/noimgCover.jpg\"></a></p>\n          <div class=\"p-2\">\n              <h4 class=\"fs-7 ellipsis\"><a href=\"./resource.html?id=${item.id}\" > ${item.title}</a></h4>\n\n              <div class=\"d-flex flex-wrap justify-content-between align-items-center text-secondary\">\n                  <span class=\"fs-7 fw-bold me-lg-2\"> ${resultScore[item.id]}</span>\n                  <ul class=\"d-flex align-items-center lh-1 me-lg-2\">\n                  ${starStr[item.id]}\n                  </ul>                                \n                  <span class=\"fs-8\">(${commentNum[item.id]})</span>\n              </div>\n\n          </div>\n      </div>\n      </div>\n      `;\n  }\n      \n}\n\n/***************** 相關主題 ***************/\nconst relatedTopic = document.querySelector('.relatedTopic');\nif(resTopic==\"JavaScript\"){\n  relatedTopic.innerHTML = `\n  <div class=\"col\">\n    <div class=\"topicItem text-center my-2  p-3 rounded-3\">\n    <a href=\"./resource_list.html?topics=HTML/CSS\"><h4 class=\"fs-6 mb-0\">HTML/CSS</h4></a>\n    </div>\n  </div>`;\n}else if(resTopic==\"HTML/CSS\"){\n  relatedTopic.innerHTML = `\n  <div class=\"col\">\n    <div class=\"topicItem text-center my-2  p-3 rounded-3\">\n    <a href=\"./resource_list.html?topics=JavaScript\"><h4 class=\"fs-6 mb-0\">JavaScript</h4></a>\n    </div>\n  </div>`;\n}else if(resTopic==\"Python\"){\n  document.querySelector('.relatedContainer').setAttribute(\"class\",\"d-none\");\n}\n\n\n\n/***************** 資源篩選 ***************/\n\nconst resourceItem = document.querySelector('.resourceItem');\nconst filterItemInput = document.querySelectorAll('.filterItem > input');  \n\nlet checkObj={};\nlet renderList=[];\nlet newSortRenderList=[];\n\n// checked 監聽 : 取得 checked 清單的關鍵字 + render\nfilterItemInput.forEach((item,index)=>{\n\n  item.addEventListener(\"change\",e=>{\n    let filterKeyword = item.getAttribute(\"name\");\n    let groupName = item.getAttribute(\"data-group\");\n    // console.log(filterKeyword,groupName);\n\n    if (e.target.checked) {\n      if(checkObj[groupName]===undefined){\n        checkObj[groupName]=[];\n        checkObj[groupName].push(filterKeyword);\n      }else{\n        checkObj[groupName].push(filterKeyword);\n      }\n    }else {\n        checkObj[groupName] = checkObj[groupName].filter(item=>{\n          return filterKeyword !=item;\n        })  \n        if(checkObj[groupName].length===0){\n          delete checkObj[groupName];\n        }\n    }\n\n    renderList = resourcesData.filter(resItem=>{\n      \n      let hasType = true ;  \n      let hasLevel =true;\n      let hasPrice =true;\n      let checkLang = true;\n  \n      if(checkObj.type){\n        hasType = checkObj.type.includes(resItem.type);\n      }\n      if(checkObj.level){\n        hasLevel = checkObj.level.includes(resItem.level);\n      }\n      if(checkObj.price){\n        hasPrice = checkObj.price.includes(resItem.price);\n      }\n  \n      checkLang = resItem.lang.some((str) => {\n        //console.log(str);\n        if (!checkObj.lang) {\n          return true;\n        }\n        return checkObj.lang.includes(str);\n      });\n  \n      return hasType && hasLevel && hasPrice && checkLang ;\n  \n    })\n    renderFilterResultList(); \n  })\n})\n\n\n\nlet sortList = [];\n\nfunction renderFilterResultList(){ \n  //render前 先排序\n  let commentScoreNum = getAverageScore();\n  let resultScore = commentScoreNum[0];\n  let commentNum = commentScoreNum[1];\n  let starStr = combineCommentStar(resultScore);\n\n    let renderfilterStr=\"\";\n    if(renderList.length===0){\n      sortList = sortResourcesList(resourcesData);\n      sortList.forEach(renderItem=>{\n        renderfilterStr += combineResouorceItemType2(renderItem,resultScore,starStr,commentNum);\n      })\n\n      if(resultNumber!==null){\n        resultNumber.setAttribute(\"class\",\"d-none\");\n      }\n      if(clearBtnText!==null){\n        clearBtnText.setAttribute(\"class\",\"d-none\");\n      }    \n\n      if(checkObj.type !== undefined || checkObj.level !== undefined || checkObj.price !== undefined || checkObj.lang !== undefined ){\n        renderfilterStr = \"沒有符合條件的項目\";\n      }\n    }else{\n      if(resultNumber!==undefined){\n         resultNumber.setAttribute(\"class\",\"d-inline-block\");\n          resultNumber.textContent = `${renderList.length} 個篩選結果`;\n      }\n      if(clearBtnText!==undefined){\n        clearBtnText.setAttribute(\"class\",\"d-inline-block\");\n      }\n      \n      if(checkObj.type==undefined && checkObj.level==undefined && checkObj.price==undefined && checkObj.lang==undefined ){\n        resultNumber.setAttribute(\"class\",\"d-none\");\n        clearBtnText.setAttribute(\"class\",\"d-none\");\n      }\n\n      sortList = sortResourcesList(renderList);\n      sortList.forEach(renderItem=>{\n        renderfilterStr += combineResouorceItemType2(renderItem,resultScore,starStr,commentNum);\n      })\n    }\n\n    if(resourceItem!==null){\n      resourceItem.innerHTML = renderfilterStr;\n    }\n}\n\n\nfunction combineResouorceItemType2(renderItem,resultScore,starStr,commentNum){\n  if( renderItem.imgUrl ===\"\"){\n    renderItem.imgUrl = \"./assets/images/resources_cover/noimgCover.jpg\";\n  }\n\n  if(resultScore[renderItem.id]===undefined || starStr[renderItem.id]=== undefined || commentNum[renderItem.id]=== undefined ){\n    return `<div class=\"row my-3 \">\n    <div class=\"col-2 \">\n      <a href=\"./resource.html?id=${renderItem.id}\" ><img src=\"${renderItem.imgUrl}\" alt=\"${renderItem.title}\"></a>\n    </div>\n      <div class=\"col-6\">\n          <h4 class=\"fs-7\"><a href=\"./resource.html?id=${renderItem.id}\" >${renderItem.title}</a></h4>\n          <div class=\"d-flex flex-wrap align-items-center\">\n              <span class=\"fs-8 text-gray fw-bold me-lg-2\"> 尚無評價</span>\n             \n          </div>\n      </div>\n      <div class=\"col-4\">\n          <div class=\"d-flex flex-column flex-lg-row  align-items-end\">\n              <a href=\"${renderItem.url}\" target=\"_blank\" role=\"button\" class=\"btn btn-tiffany my-2 w-75 mx-2\">前往資源</a>\n              <a href=\"./resource.html?id=${renderItem.id}\"  role=\"button\" class=\"btn btn-yellowBrown my-2 w-75 mx-2\">查看內容</a>\n          </div>\n      </div>\n    </div>`;\n  }else{\n    return `<div class=\"row my-3 \">\n  <div class=\"col-2 \">\n     <a href=\"./resource.html?id=${renderItem.id}\" ><img src=\"${renderItem.imgUrl}\" alt=\"${renderItem.title}\"></a>  \n  </div>\n    <div class=\"col-6\">\n     <h4 class=\"fs-7\"><a href=\"./resource.html?id=${renderItem.id}\" >${renderItem.title}</a></h4>\n        <div class=\"d-flex flex-wrap align-items-center text-secondary\">\n            <span class=\"fs-7 fw-bold me-lg-2\"> ${resultScore[renderItem.id]}</span>\n            <ul class=\"d-flex align-items-center lh-1 me-lg-2  \">\n            ${starStr[renderItem.id]}\n            </ul>                                \n            <span class=\"fs-8\">(${commentNum[renderItem.id]})</span>\n           \n        </div>\n    </div>\n    <div class=\"col-4\">\n        <div class=\"d-flex flex-column flex-lg-row  align-items-end\">\n          <a href=\"${renderItem.url}\" target=\"_blank\" role=\"button\" class=\"btn btn-tiffany my-2 w-75 mx-2\">前往資源</a>\n          <a href=\"./resource.html?id=${renderItem.id}\"  role=\"button\" class=\"btn btn-yellowBrown my-2 w-75 mx-2\">查看內容</a>\n        </div>  \n    </div>\n  </div>\n      `;\n  }\n  \n}\n\n/***************** n 筆結果 / 清除篩選  ***************/\n\nconst resultNumber = document.querySelector('.resultNumber');\nconst clearBtnText = document.querySelector('.clearBtnText');\nconst clearFilterBtn = document.querySelector('#clearFilterBtn');\n\n  if(clearFilterBtn!==null){\n    clearFilterBtn.addEventListener(\"click\",e=>{\n      if(checkObj.type){\n        delete checkObj.type;\n      }\n      if(checkObj.level){\n        delete checkObj.level;\n      }\n      if(checkObj.price){\n        delete checkObj.price;\n      }\n      if(checkObj.lang){\n        delete checkObj.lang;\n      }\n      filterItemInput.forEach(item=>{\n        item.checked = false;\n      })\n      renderList =[];\n      renderFilterResultList();\n    })\n  }\n  \n\n\n\n/*********************** 排序 ***********************/\n\nconst resourceSort = document.querySelector('#resourceSort');\n\nfunction sortResourcesList(resRenderList){\n  if(resourceSort!==null || resourceSort!==undefined){\n\n     if(resourceSort?.value==\"heightRate\"){\n      resRenderList = resRenderList?.sort((a,b)=>{\n        return b.averageScore - a.averageScore;\n     })\n     \n    }else if(resourceSort?.value==\"new\"){\n      resRenderList = resRenderList?.sort((a,b)=>{\n        return b.id - a.id;\n     })\n\n    }\n  }\n   \n    return resRenderList;\n}\n\nif(resourceSort!==null){\n  resourceSort.addEventListener(\"change\",e=>{\n    renderFilterResultList();\n  })\n}\n","const apiUrl=\"https://json-server-vercel-ochre.vercel.app\";\r\n\r\nconst signUpForm = document.querySelector('form.signUpForm');  //form\r\n\r\nconst signupLastName = document.querySelector('#signupLastName');\r\nconst signupfirstName = document.querySelector('#signupfirstName');\r\nconst signupMail = document.querySelector('#signupMail');\r\nconst signupPw = document.querySelector('#signupPw');\r\nconst signupPwConfirm = document.querySelector('#signupPwConfirm');\r\n\r\nconst signUpFormInputs = document.querySelectorAll('input.signupInput');  //input\r\nconst btnSignUp = document.querySelector('#btnSignUp');\r\n\r\n\r\nfunction initSignup(){\r\n    getUserList();\r\n}\r\ninitSignup();\r\n\r\n\r\n\r\n//驗證欄位內容\r\nconst constraints ={\r\n    lastname:{\r\n        presence: {message: \"必填欄位\"},\r\n    },\r\n    firstname:{\r\n        presence: {message: \"必填欄位\"},\r\n    },\r\n    email:{\r\n        presence: {message: \"必填欄位\"},\r\n        email:{\r\n            email:true,\r\n            message: \"請填寫正確的信箱格式\"\r\n        },\r\n       \r\n    },\r\n    password:{\r\n        presence: {message: \"必填欄位\"},\r\n        length: {\r\n            minimum: 5, \r\n            message: \"密碼長度請大於5\"\r\n        }\r\n    },\r\n    confirmpw:{\r\n        presence: {message: \"必填欄位\"},\r\n        equality:{\r\n            attribute:\"password\",\r\n            message: \"與前者輸入密碼不同\",\r\n        }\r\n    }\r\n}\r\n\r\n\r\nsignUpFormInputs.forEach(item=>{\r\n    item.addEventListener(\"change\",e=>{\r\n       \r\n        item.nextElementSibling.textContent = '';\r\n        let errors = validate(signUpForm, constraints);\r\n\r\n        let result = usersData.filter(userItem=>{\r\n            return userItem.email === signupMail.value;\r\n        })\r\n\r\n        if(result.length!==0){\r\n            document.querySelector('.email').textContent=\"此帳號已存在\";\r\n        }else{\r\n            document.querySelector('.email').textContent =\"\";\r\n        }\r\n\r\n    \r\n        //有錯就呈現在畫面上\r\n        if (errors) {\r\n          Object.keys(errors).forEach( keys=> {\r\n            document.querySelector(`.${keys}`).textContent = errors[keys][0].split(\" \")[1];\r\n          });\r\n        }\r\n    })\r\n})\r\n\r\n\r\n\r\n//取得用戶清單\r\nlet usersData = [];\r\nfunction getUserList(){\r\n    axios.get(`https://json-server-vercel-ochre.vercel.app/users`).then(res=>{\r\n        usersData = res.data\r\n    }).catch(err=>{\r\n        console.log(err);\r\n    })\r\n}\r\n\r\n\r\n//註冊 post\r\nif(btnSignUp!==null){\r\n    btnSignUp.addEventListener(\"click\",e=>{\r\n    e.preventDefault();\r\n\r\n    if(signupLastName.value===\"\"||signupfirstName.value===\"\"||signupMail.value===\"\"||signupPw.value===\"\"||signupPwConfirm.value===\"\"){\r\n        return;\r\n    }\r\n\r\n    signUpFormInputs.forEach(item=>{\r\n        if(item.nextElementSibling.textContent !== '' ){\r\n            console.log(\"有錯誤訊息\");\r\n            return;\r\n        }\r\n    })\r\n\r\n    if(signupPw.value!== signupPwConfirm.value){\r\n        return;\r\n    }\r\n    axios.post(`${apiUrl}/users`,{\r\n        \"lastName\": signupLastName.value,\r\n        \"firstName\": signupfirstName.value,\r\n        \"email\": signupMail.value,\r\n        \"password\": signupPw.value,\r\n        \"role\": \"user\",\r\n        \"title\":\"\",\r\n        \"experiences\":\"\",\r\n        \"links\":{\"websiteUrl\":\"\"}\r\n\r\n    }).then(res=>{\r\n        Swal.fire({\r\n            icon: 'success',\r\n            title: '成功註冊',\r\n            iconColor:\"#4AA9B6\",            \r\n            confirmButtonColor:\"#4AA9B6\",\r\n            showConfirmButton: true,\r\n        });\r\n        setTimeout(() => { location.href = `./login.html`;}, 5000);\r\n        console.log(res)\r\n\r\n    }).catch(err=>{\r\n       \r\n        Swal.fire({\r\n            icon: 'error',\r\n            title: '連線有誤',\r\n        });\r\n        console.log(err)\r\n    })\r\n\r\n})\r\n}\r\n\r\n\r\n","\r\n\r\nfunction Ftime (timespan) {\r\n    var dateTime = new Date(timespan * 1000);\r\n    var year = dateTime.getFullYear();\r\n    var month = dateTime.getMonth() + 1;\r\n    var day = dateTime.getDate();\r\n    var hour = dateTime.getHours();\r\n    var minute = dateTime.getMinutes();\r\n   \r\n    var now = Date.parse(new Date());  //typescript轉換\r\n    var milliseconds = 0;\r\n    var timeSpanStr;\r\n    //時間差\r\n    milliseconds = (now / 1000) - timespan;\r\n\r\n    // < 1min\r\n    if (milliseconds <= 60) {\r\n        timeSpanStr = '剛剛';\r\n    }\r\n    // > 1min < 60min\r\n    else if (60 < milliseconds && milliseconds <= 60 * 60) {\r\n        timeSpanStr = Math.ceil((milliseconds / (60))) + '分鐘前';\r\n    }\r\n    // >1hr < 24hr \r\n    else if (60 * 60 < milliseconds && milliseconds <= 60 * 60 * 24) {\r\n        timeSpanStr = Math.ceil(milliseconds / (60 * 60)) + '小時前';\r\n    }\r\n    // >1day > 15day \r\n    else if (60 * 60 * 24 < milliseconds && milliseconds <= 60 * 60 * 24 * 30) {\r\n        timeSpanStr = Math.ceil(milliseconds / (60 * 60 * 24)) + '天前';\r\n    }\r\n    // > 1month < 12 month \r\n    else if (60 * 60 * 24 * 30 < milliseconds && milliseconds <= 60 * 60 * 24 * 30 * 12){\r\n        timeSpanStr = Math.ceil(milliseconds / (60 * 60 * 24 * 30)) + '個月前';\r\n    }\r\n    // > 1year\r\n    else {\r\n        timeSpanStr = year + '年' + month + '月' + day + '日 ' + hour + ':' + minute;   \r\n    }\r\n    return timeSpanStr;\r\n}\r\n\r\n\r\n//  https://beltxman.com/1576.html\r\n"]}